# name: test/sql/storage/compression/rle_optimized/rle_basic_sort.test
# description: Test sorting before RLE compression
# group: [rle]

# load the DB from disk
load __TEST_DIR__/test_rle.db

statement ok
PRAGMA wal_autocheckpoint='1TB';

statement ok
PRAGMA force_compression = 'rle'

statement ok
CREATE TABLE test (a INTEGER, b INTEGER);

statement ok
INSERT INTO test VALUES (1,1),(2,2),(1,1),(2,2),(1,1),(2,2);

statement ok
checkpoint

query II
SELECT * FROM test;
----
1   1
2   2
1   1
2   2
1   1
2   2

statement ok
PRAGMA force_compression_sorting = true

statement ok
DROP TABLE IF EXISTS test;

statement ok
CREATE TABLE test (a INTEGER, b INTEGER);

statement ok
INSERT INTO test VALUES (1,1),(2,2),(1,1),(2,2),(1,1),(2,2);

statement ok
checkpoint

query II
SELECT * FROM test;
----
1   1
1   1
1   1
2   2
2   2
2   2
