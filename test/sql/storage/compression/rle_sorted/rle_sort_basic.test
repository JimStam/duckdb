# name: test/sql/storage/compression/rle_sorted/rle_sort_basic.test
# description: Test a basic integer sort before RLE compression
# group: [rle_sorted]

# load the DB from disk
load __TEST_DIR__/test_rle.db

statement ok
PRAGMA wal_autocheckpoint='1TB';

statement ok
PRAGMA force_compression = 'rle'

statement ok
PRAGMA preserve_insertion_order = false

statement ok
PRAGMA force_row_group_replacement = true

statement ok
CREATE TABLE test (a INTEGER, b INTEGER);

statement ok
INSERT INTO test VALUES (1,1),(2,2),(1,1);

statement ok
checkpoint

query II
SELECT * FROM test;
----
1	1
1	1
2	2

statement ok
PRAGMA preserve_insertion_order = true

statement ok
PRAGMA force_row_group_replacement = true

statement ok
DROP TABLE IF EXISTS test;

statement ok
CREATE TABLE test (a INTEGER, b INTEGER);

statement ok
INSERT INTO test VALUES (1,1),(2,2),(1,1),(2,2),(1,1),(2,2), (1,1);

statement ok
checkpoint

query II
SELECT * FROM test;
----
1	1
2	2
1	1
2	2
1	1
2	2
1	1

statement ok
DROP TABLE IF EXISTS test;

statement ok
PRAGMA preserve_insertion_order = false

statement ok
PRAGMA force_row_group_replacement = true

statement ok
CREATE TABLE test (a INTEGER, b INTEGER);

statement ok
INSERT INTO test VALUES (1,1),(2,2),(1,1),(2,2),(1,1),(2,2),(1,1);

statement ok
checkpoint

query II
SELECT * FROM test;
----
1	1
1	1
1	1
1	1
2	2
2	2
2	2
