# name: test/sql/storage/compression/rle_sorted/segment_leak_checkpoint.test
# description: Test that we do not add a segment per checkpoint
# group: [rle_sorted]

#mode output_result

load __TEST_DIR__/test_segment_leak.db

statement ok
PRAGMA force_checkpoint;

statement ok
CREATE TABLE integers AS SELECT i FROM range(2) tbl(i);

statement ok
CHECKPOINT;

statement ok
CHECKPOINT;

loop i 0 2

statement ok
UPDATE integers SET i=i;

statement ok
CHECKPOINT;

query I nosort expected_blocks
select total_blocks from pragma_database_size();


endloop