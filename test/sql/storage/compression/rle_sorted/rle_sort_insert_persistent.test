# name: test/sql/storage/compression/rle_sorted/rle_sort_insert_persistent.test
# description: Test if persistent segments work correctly with inserts and NULLs (STANDARD_VECTOR_SIZE=4, ROW_GROUP_VECTOR_COUNT=1)
# group: [rle_sorted]

# load the DB from disk
load __TEST_DIR__/test_rle.db

statement ok
PRAGMA wal_autocheckpoint='1TB'

statement ok
PRAGMA force_compression = 'rle'

statement ok
PRAGMA force_compression_sorting=True

statement ok
CREATE TABLE nulls(i INTEGER)

statement ok
INSERT INTO nulls VALUES (1), (3), (2), (4), (6), (5);

query I
SELECT * FROM nulls;
----
1
3
2
4
6
5

statement ok
CHECKPOINT

query I
SELECT * FROM nulls;
----
1
2
3
4
5
6

statement ok
INSERT INTO nulls VALUES (8), (7);

query I
SELECT * FROM nulls;
----
1
2
3
4
5
6
8
7

restart

query I
SELECT * FROM nulls;
----
1
2
3
4
5
6
7
8