# name: test/sql/storage/compression/rle_sorted/force_compression_per_column.test
# description: Test CREATE TABLE using Compression Option while sorting
# group: [rle_sorted]

# load the DB from disk
load __TEST_DIR__/test_compression_hint.db

statement ok
PRAGMA force_compression_sorting = true;

statement ok
CREATE TABLE T (a INTEGER USING COMPRESSION RLE, b INTEGER USING COMPRESSION BITPACKING, C INTEGER USING COMPRESSION UNCOMPRESSED)

statement ok
INSERT INTO T VALUES (1,1,1), (1,1,1), (1,1,1), (2,2,2), (2,2,2), (3,3,3)

restart

query I
SELECT compression FROM pragma_storage_info('T') WHERE segment_type ILIKE 'INTEGER' LIMIT 3
----
RLE
BitPacking
Uncompressed

statement ok
ALTER TABLE T RENAME COLUMN a TO a_1

query III
SELECT * FROM T
----
1	1	1
1	1	1
1	1	1
2	2	2
2	2	2
3	3	3

query I
SELECT compression FROM pragma_storage_info('T') WHERE segment_type ILIKE 'INTEGER' LIMIT 3
----
RLE
BitPacking
Uncompressed
