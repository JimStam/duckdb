# name: test/sql/storage/compression/rle_sorted/rle_sort_cardinality500.test
# description: Test if cardinalities above 500 are not included as key columns
# group: [rle_sorted]

# load the DB from disk
load __TEST_DIR__/test_rle.db

statement ok
PRAGMA wal_autocheckpoint='1TB';

statement ok
PRAGMA force_compression = 'rle'

statement ok
PRAGMA force_compression_sorting = true

statement ok
CREATE TABLE test (a INTEGER, b INTEGER);

statement ok
INSERT INTO test SELECT i,1 FROM range(10000) tbl(i);

statement ok
checkpoint

mode output_result

statement ok
SELECT * FROM test;